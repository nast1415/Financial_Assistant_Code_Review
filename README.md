# Financial_Assistant_Code_Review
Общее описание приложения.

Приложение Financial assistant помогает пользователю контролировать свои расходы. Пользователь может добавлять в приложение свои траты и доходы. Все траты разделены на категории. Есть возможность просматривать статистику за определенный период и прогнозы на будущее. Для статистики расходов строится график расходов за день или за месяц, в зависимости от выбранного промежутка времени. Также рисуется диаграмма расходов по категориям в выбранный промежуток времени. Прогнозы расходов показываются в виде графика предполагаемых расходов на следующий год по месяцам и диаграммы предполагаемых расходов по каждой из категорий на следующий месяц.
Пользователь имеет доступ к списку последних действий и может при желании отредактировать введенную ранее информацию.
Также пользователь может настроить отображение оповещений.


Детальное описание приложения.

Приложение состоит из экрана приветствия, за который отвечает LoginActivity, экранов регистрации и входа (SignUpActivity и SignInActivity), а также navigation drawer-а, которому соответствует MainActivity и фрагменты, отвечающие за экраны информации, добавления трат, добавления доходов, статистики, последних действий и настроек. Все активити лежат в /app/src/main/java/ru/spbau/mit/starlab/financialassistant. Фрагменты, в том числе для не реализованных в данный момент функций, таких как регулярные доходы, регулярные траты, кредиты и желаемые покупки (RegularIncomesFragment, RegularExpensesFragment, CreditsFragment и WantedExpensesFragment), лежат там же в папке fragments. Все xml-файлы с описанием экранов активити и фрагментов лежат в /app/src/main/res/layout. Описание drawer-а и некоторых меню находится в /app/src/main/res/menu. В /app/src/main/res/values находятся используемые стили для разных элементов экрана (styles.xml), описание цветов (colors.xml), строковые константы (strings.xml) и еще что-то.

При запуске приложения, открывается экран LoginActivity, на котором есть 2 кнопки: «войти» и «зарегистрироваться». При нажатии на кнопку «зарегистрироваться», вызывается метод onBtnSignUpClick и происходит переход на SignUpActivity, а при нажатии на кнопку «войти» вызывается onBtnSignInClick и происходит переход на SignInActivity.

На экране SignUpActivity есть поле для ввода логина и пароля и кнопка зарегистрироваться. При нажатии на эту кнопку, вызывается метод attemptLogin, который проверяет валидность логина и пароля и либо выводит сообщение об ошибке, либо создает и запускает в новом потоке UserLoginTask, который проверяет, не был ли уже зарегистрирован пользователь с таким логином, и если нет, добавляет в базу (еще не реализовано).

SignInActivity устроен аналогично SignUpActivity, за исключением того, что в UserLoginTask проверяется наличие такого пользователя с таким паролем в базе (сейчас захардкожено), и затем, в случае успеха, происходит переход на MainActivity.

При переходе на MainActivity, вызывается метод onCreate, инициализирующий некоторые значения для drawer-а и делающий переход на informationFragment. В MainActivity также содержатся методы обработки действий при нажатиях, например, onNavigationItemSelected для перехода между фрагментами, а также onOptionsItemSelected, onCreateOptionsMenu, onBackPressed. Еще в MainActivity находятся методы для работы с базой и получения из нее необходимых данных — addDataToLastActions, addNewExpense, addNewIncome, getLastActions, getDataForStatistics, …, а также метод showDatePickerDialog для создания диалога выбора даты и метод onShowStatisticsBtnClick для создания экрана статистики с графиками, которому соответствует ShowStatisticsFragment.

InformationFragment в данный момент только показывает приветствие.

На фрагменте добавления трат, которому соответствует ExpensesFragment, находятся поля для ввода категории, даты, названия траты, суммы и комментария, а также кнопка «записать», при зажатии на которую вызывается метод addNewExpense из MainActivity.

Фрагмент добавления доходов (IncomesFragment) аналогичен фрагменту добавления трат, за исключением отсутствия категории. При нажатии на кнопку «записать», вызывается метод addNewIncome.

На фрагменте статистики (StatisticsFragment) находятся radiobutton-ы для выбора, статистику показывать, или прогнозы, а также поля для ввода даты начала и конца периода, на котором считается статистика и кнопка «показать». При нажатии на кнопку, вызывается метод onShowStatisticsBtnClick, который собирает из базы нужные для статистики или прогнозов данные и создает экран ShowStatisticsFragment.

В фрагменте ShowStatisticsFragment при создании вызывается метод onCreateView, который считает статистику или прогнозы по предоставленным данным и рисует график и диаграмму, используя вспомогательные методы: 
calcStatisticsForPieChart — по промежутку времени (начальному и конечному календарю) и массивам названий категорий, дат и сумм трат вычисляет массивы xs и ys, по которым строится диаграмма расходов по категориям,
calcDaysStatisticsForLineChart, calcMonthsStatisticsForLineChart, calcPredictionsForLineChart и calcPredictionsForPieChart также считают данные для графиков.
Еще есть несколько вспомогательные методы, такие как findMinDate, getSumCategoryOnPeriod, …, метод extrapolate, экстраполирующий размер трат в следующем месяце, по списку трат в предыдущих месяцах и методы updateLineChart и updatePieChart, рисующие по предоставленным данным график и диаграмму соответственно.

При создании фрагмента RecentActionsFragment вызывается метод onCreateView, в котором загружается и выводится список последних действий, а также инициализируются обработчик нажатия на элемент списка, который открывает EditActionActivity, где должно происходить редактирование элемента (не до конца реализовано).
